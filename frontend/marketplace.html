<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AgriMitra | Crop Marketplace</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
:root {--green:#2d6a4f;--dark:#1b4332;--light:#d8f3dc;--bg:#f6fff9;}
*{box-sizing:border-box;}
body{margin:0;font-family:Segoe UI,Arial;background:var(--bg);color:#222;transition: background 0.3s;}
nav{display:flex;justify-content:space-between;align-items:center;background:var(--green);color:#fff;padding:12px 20px;position:relative;transition: background 0.3s;}
.logo{font-weight:bold;font-size:20px;}
nav ul{list-style:none;display:flex;gap:20px;margin:0;padding:0;transition: all 0.3s;}
nav a{color:#fff;text-decoration:none;font-weight:500;transition: color 0.3s;}
nav a:hover{text-decoration:underline;}
.menu-toggle{display:none;font-size:26px;cursor:pointer;}
@media(max-width:768px){
  nav ul{display:none;flex-direction:column;gap:14px;background:rgba(0,0,0,0.9);position:absolute;top:100%;left:0;width:100%;padding:18px 0;text-align:center;}
  nav ul.show{display:flex;}
  .menu-toggle{display:block;}
}
.container{max-width:1100px;margin:20px auto;padding:20px;display:flex;gap:20px;transition: all 0.3s;}
.sidebar{flex:0 0 220px;background:#fff;border-radius:12px;padding:20px;box-shadow:0 4px 12px rgba(0,0,0,0.08);height:fit-content;transition: all 0.3s;}
.sidebar h3{margin-top:0;color:var(--green);}
.sidebar ul{list-style:none;padding:0;margin:0;}
.sidebar li{margin:10px 0;}
.sidebar a{text-decoration:none;color:#333;font-weight:500;transition: color 0.3s;}
.sidebar a:hover{color:var(--green);}
.main{flex:1;display:flex;flex-direction:column;gap:20px;}
.card{background:#fff;border-radius:12px;padding:20px;box-shadow:0 4px 12px rgba(0,0,0,0.08);transition: transform 0.3s, box-shadow 0.3s;}
.card:hover{transform: translateY(-4px);box-shadow:0 6px 16px rgba(0,0,0,0.12);}
.crop-list{display:flex;flex-wrap:wrap;gap:20px;}
.crop-card{background:#f8fdf7;border-radius:12px;padding:12px;flex:1 1 200px;display:flex;flex-direction:column;align-items:center;text-align:center;transition:all 0.3s;}
.crop-card img{width:100%;height:140px;object-fit:cover;border-radius:6px;margin-bottom:8px;}
button{padding:10px 16px;background:var(--green);color:#fff;border:none;border-radius:8px;cursor:pointer;transition:0.3s;}
button:hover{background:var(--dark);}
#langSelect{padding:6px;border-radius:6px;font-weight:600;margin-left:10px;}
@media(max-width:900px){.container{flex-direction:column;}.sidebar{flex:none;}}
</style>
</head>
<body>

<nav>
  <div class="logo">üåæ AgriMitra</div>
  <span class="menu-toggle" onclick="toggleMenu()">‚ò∞</span>
  <ul id="navbar-links"></ul>
  <select id="langSelect" onchange="changeLanguage()">
    <option value="en">English</option>
    <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
    <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</option>
    <option value="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</option>
    <option value="kn">‡≤ï‡≤®‡≥ç‡≤®‡≤°</option>
  </select>
</nav>

<div class="container">
  <div class="sidebar">
    <h3 id="menu-title">Marketplace Menu</h3>
    <ul>
      <li><a href="farmer.html">‚ûï Farmer Dashboard</a></li>
      <li><a href="equipment.html">Equipment</a></li>
      <li><a href="#" onclick="logout()">Logout</a></li>
    </ul>
  </div>

  <div class="main">
    <div class="card">
      <h2 id="market-title">üå± Crop Marketplace</h2>
      <div class="crop-list" id="list"></div>
    </div>
  </div>
</div>

<script>
const API = "http://127.0.0.1:5000";
let user = JSON.parse(localStorage.getItem("user")||"{}");

const translations = {
  en:{menu:"Marketplace Menu", market_title:"üå± Crop Marketplace"},
  hi:{menu:"‡§Æ‡§æ‡§∞‡•ç‡§ï‡•á‡§ü‡§™‡•ç‡§≤‡•á‡§∏ ‡§Æ‡•á‡§®‡•ç‡§Ø‡•Ç", market_title:"üå± ‡§´‡§∏‡§≤ ‡§Æ‡§æ‡§∞‡•ç‡§ï‡•á‡§ü‡§™‡•ç‡§≤‡•á‡§∏"},
  ta:{menu:"‡Æö‡Æ®‡Øç‡Æ§‡Øà ‡ÆÆ‡ØÜ‡Æ©‡ØÅ", market_title:"üå± ‡Æ™‡ÆØ‡Æø‡Æ∞‡Øç ‡Æö‡Æ®‡Øç‡Æ§‡Øà"},
  te:{menu:"‡∞Æ‡∞æ‡∞∞‡±ç‡∞ï‡±Ü‡∞ü‡±ç‚Äå‡∞™‡±ç‡∞≤‡±á‡∞∏‡±ç ‡∞Æ‡±Ü‡∞®‡±Ç", market_title:"üå± ‡∞™‡∞Ç‡∞ü ‡∞Æ‡∞æ‡∞∞‡±ç‡∞ï‡±Ü‡∞ü‡±ç"},
  kn:{menu:"‡≤Æ‡≤æ‡≤∞‡≥Å‡≤ï‡≤ü‡≥ç‡≤ü‡≥Ü ‡≤Æ‡≥Ü‡≤®‡≥Å", market_title:"üå± ‡≤¨‡≥Ü‡≤≥‡≥Ü ‡≤Æ‡≤æ‡≤∞‡≥Å‡≤ï‡≤ü‡≥ç‡≤ü‡≥Ü"}
};
let lang = localStorage.getItem("lang")||"en";
let L = translations[lang];

function applyTranslations(){ 
  L = translations[localStorage.getItem("lang")||"en"];
  document.getElementById("langSelect").value=lang;
  document.getElementById("menu-title").textContent=L.menu;
  document.getElementById("market-title").textContent=L.market_title;
  renderNavbar();
}
function changeLanguage(){ lang=document.getElementById("langSelect").value; localStorage.setItem("lang",lang); applyTranslations();}
function toggleMenu(){ document.getElementById("navbar-links").classList.toggle("show"); }
function renderNavbar(){ 
  const nav=document.getElementById("navbar-links");
  nav.innerHTML=`<li><a href="index.html">Home</a></li><li><a href="farmer.html">Farmer</a></li><li><a href="equipment.html">Equipment</a></li>`;
}
function logout(){ localStorage.removeItem("user"); window.location="index.html"; }

async function load(){
  const res = await fetch(API+"/crops");
  const data = await res.json();
  const el = document.getElementById("list");
  if(!data || !data.length){ el.innerHTML="<p>No crops available.</p>"; return; }
  el.innerHTML = data.map((c,i)=>`
    <div class="crop-card" style="animation-delay:${i*0.1}s">
      ${c.image_url?`<img src="${API}/${c.image_url}">`:''}
      <h3>${c.crop_name}</h3>
      <div class="price">${c.quantity} units @ ‚Çπ${c.price}</div>
      <small>Farmer: ${c.farmer_name||'Unknown'}</small>
      <button onclick="order(${c.id})">Place Order</button>
    </div>`).join("");
}

function order(id){ alert("Order feature coming soon for crop ID "+id); }

applyTranslations();
load();
</script>

</body>
</html>
