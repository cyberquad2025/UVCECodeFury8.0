<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AgriMitra | Home</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root {
      --green: #2d6a4f;
      --light: #d4fc79;
      --white: #fff;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Segoe UI", system-ui, -apple-system, "Helvetica Neue", Arial;
      background: linear-gradient(135deg, #43cea2, #185a9d);
      color: var(--white);
    }

    /* Weather strip */
    .weather-strip {
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:center;
      padding:8px 12px;
      background: rgba(0,0,0,0.22);
      border-bottom: 1px solid rgba(255,255,255,0.12);
      font-size: 14px;
      flex-wrap:wrap;
    }
    .weather-pill {
      background: rgba(255,255,255,0.12);
      padding:6px 10px;
      border-radius: 999px;
      display:inline-flex;
      gap:8px;
      align-items:center;
      font-weight:600;
    }
    .small-muted { opacity: .9; font-weight:500; }

    /* Navbar */
    nav {
      display:flex;
      justify-content:space-between;
      align-items:center;
      background: rgba(0,0,0,0.18);
      padding:14px 20px;
      position:relative;
    }
    .logo { font-size:20px; font-weight:700; display:flex; gap:8px; align-items:center; }
    nav ul { list-style:none; display:flex; gap:20px; margin:0; padding:0; align-items:center; }
    nav a { color:var(--white); text-decoration:none; font-weight:600; }
    nav a:hover{ color: var(--light); }

    /* Hamburger menu */
    .menu-toggle{display:none;font-size:26px;cursor:pointer;}
    @media(max-width:768px){
      nav ul{display:none;flex-direction:column;gap:14px;background:rgba(0,0,0,0.9);
             position:absolute;top:100%;left:0;width:100%;padding:18px 0;text-align:center;}
      nav ul.show{display:flex;}
      .menu-toggle{display:block;}
    }

    /* Ticker */
    .ticker-wrap { background: rgba(0,0,0,0.14); overflow:hidden; border-top:1px solid rgba(255,255,255,0.08); border-bottom:1px solid rgba(255,255,255,0.08); }
    .ticker { display:inline-block; white-space:nowrap; padding:10px 16px; animation: scroll 30s linear infinite; }
    .ticker span { margin: 0 28px; display:inline-flex; gap:10px; align-items:center; }
    .badge { background: rgba(255,255,255,0.12); padding:4px 10px; border-radius:6px; font-weight:700; }

    @keyframes scroll {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }

    /* Hero */
    .hero { display:flex; gap:30px; align-items:center; justify-content:space-between; padding:60px 8%; min-height:70vh; flex-wrap:wrap; }
    .hero-text { max-width:600px; flex:1; }
    h1 { font-size:44px; margin:0 0 12px; line-height:1.05; font-weight:800; color:#fff; text-shadow: 0 4px 18px rgba(0,0,0,0.2); }
    .lead { font-size:17px; color: rgba(255,255,255,0.95); margin-bottom:18px; }
    .hero-buttons { display:flex; gap:12px; flex-wrap:wrap; }
    .btn { padding:12px 20px; border-radius:8px; border:0; font-weight:800; cursor:pointer; }
    .btn-primary { background: var(--green); color:var(--white); }
    .btn-primary:hover { background:#1b4332; }
    .btn-secondary { background:transparent; color:var(--white); border:2px solid rgba(255,255,255,0.18); }
    .btn-secondary:hover { background:var(--white); color:var(--green); }

    .hero-img { flex:1; display:flex; justify-content:center; align-items:center; }
    .hero-img img { max-width:420px; width:100%; animation: float 4s ease-in-out infinite; }
    @keyframes float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-14px)} }

    /* Widget */
    .widget { margin: 24px 8%; background: rgba(255,255,255,0.08); padding:16px; border-radius:12px; backdrop-filter: blur(2px); color:#fff; max-width:1040px; }
    .widget h3 { margin:0 0 10px; }
    .widget form { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .widget select, .widget button { padding:10px 12px; border-radius:8px; border: 0; font-weight:700; }
    .widget select { min-width:140px; background:#fff; color:#222; }
    .widget button { background:var(--green); color:#fff; border:0; }
    .results { margin-top:12px; color:#fff; font-weight:600; }

    @media (max-width: 900px) {
      .hero { flex-direction:column-reverse; padding:40px 6%; min-height:auto; text-align:center; }
      h1 { font-size:34px; }
      .hero-img img { max-width:300px; }
      .lead{font-size:15px;}
      .hero-buttons{justify-content:center;}
      .ticker{animation-duration:40s;}
    }
    @media(max-width:500px){
      h1{font-size:26px;}
      .btn{padding:10px 16px;font-size:14px;}
      .widget{margin:16px 4%;}
      .widget form{flex-direction:column;align-items:stretch;}
      .widget select,.widget button{width:100%;}
    }
  </style>
</head>
<body>

  <!-- Weather strip -->
  <div class="weather-strip" id="weatherStrip">
    <span class="small-muted">Loading weather‚Ä¶</span>
  </div>

  <!-- Navbar -->
  <nav>
    <div class="logo">üåæ AgriMitra</div>
    <span class="menu-toggle" onclick="toggleMenu()">‚ò∞</span>
    <ul id="navbar-links">
      <li><a href="index.html" id="nav-home">Home</a></li>
      <li><a href="marketplace.html" id="nav-market">Crop Marketplace</a></li>
      <li><a href="equipment.html" id="nav-equip">Equipment</a></li>
      <li><a href="fertilizers.html" id="nav-fertilizers">Fertilizers & Manures</a></li>
      <li><a href="seeds.html" id="nav-seeds">Seeds</a></li>
      <li><a href="loan-schemes.html" id="nav-loan">Loan Schemes</a></li>
      <li id="dashboard-link" style="display:none;"><a href="#" id="nav-dashboard">Dashboard</a></li>
      <li id="login-link"><a href="login.html" id="nav-login">Login/Signup</a></li>
      <li id="logout-link" style="display:none;"><a href="#" onclick="logout()" id="nav-logout">Logout</a></li>
    </ul>
    <select id="langSelect" onchange="changeLanguage()" style="padding:6px;border-radius:6px;font-weight:600;">
      <option value="en" selected>English</option>
      <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
      <option value="kn">‡≤ï‡≤®‡≥ç‡≤®‡≤°</option>
      <option value="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</option>
      <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</option>
    </select>
  </nav>

  <!-- Price Ticker -->
  <div class="ticker-wrap">
    <div class="ticker" id="priceTicker"></div>
  </div>

  <!-- Hero Section -->
  <section class="hero">
    <div class="hero-text">
      <h1>Empowering Farmers,<br> Transforming Agriculture</h1>
      <p class="lead">A transparent platform that helps farmers get fair prices, rent equipment affordably and plan according to weather.</p>
      <div class="hero-buttons">
        <button class="btn btn-primary" onclick="gotoDashboard()">Sell Your Crops</button>
        <button class="btn btn-secondary" onclick="window.location='equipment.html'">Find Equipment</button>
      </div>
    </div>
    <div class="hero-img">
      <img src="farmer.png" alt="Farming illustration">
    </div>
  </section>

  <!-- Price Widget -->
  <div class="widget" id="priceWidget">
    <h3>üîé Check Market Price</h3>
    <form id="priceForm">
      <select id="cropSelect">
        <option>Wheat</option>
        <option>Rice</option>
        <option>Maize</option>
        <option>Onion</option>
        <option>Tomato</option>
      </select>
      <select id="regionSelect">
        <option>Maharashtra</option>
        <option>Karnataka</option>
        <option>Gujarat</option>
        <option>Punjab</option>
        <option>Tamil Nadu</option>
      </select>
      <button type="submit">Get Price</button>
    </form>
    <div class="results" id="priceResult">Get the latest price for your crop and region.</div>
  </div>

  <script>
    // --- Language Support ---
    const translations = {
      en: {
        hero_title: "Empowering Farmers,<br> Transforming Agriculture",
        hero_lead: "A transparent platform that helps farmers get fair prices, rent equipment affordably and plan according to weather.",
        sell_btn: "Sell Your Crops",
        equip_btn: "Find Equipment",
        widget_title: "üîé Check Market Price",
        widget_result: "Get the latest price for your crop and region.",
        nav_home: "Home",
        nav_market: "Crop Marketplace",
        nav_equip: "Equipment",
        nav_fertilizers: "Fertilizers & Manures",
        nav_seeds: "Seeds",
        nav_login: "Login/Signup",
        nav_dashboard: "Dashboard",
        nav_logout: "Logout",
        nav_loan: "Loan Schemes"
      },
      // Other languages omitted for brevity
    };
    function changeLanguage(){
      const lang = document.getElementById("langSelect").value;
      localStorage.setItem("lang", lang);
      const L = translations[lang] || translations.en;
      document.querySelector(".hero-text h1").innerHTML = L.hero_title;
      document.querySelector(".lead").textContent = L.hero_lead;
      document.querySelector(".btn-primary").textContent = L.sell_btn;
      document.querySelector(".btn-secondary").textContent = L.equip_btn;
      document.querySelector("#priceWidget h3").textContent = L.widget_title;
      document.querySelector("#priceResult").textContent = L.widget_result;
      document.getElementById("nav-home").textContent = L.nav_home;
      document.getElementById("nav-market").textContent = L.nav_market;
      document.getElementById("nav-equip").textContent = L.nav_equip;
      document.getElementById("nav-fertilizers").textContent = L.nav_fertilizers;
      document.getElementById("nav-seeds").textContent = L.nav_seeds;
      document.getElementById("nav-login").textContent = L.nav_login;
      document.getElementById("nav-dashboard").textContent = L.nav_dashboard;
      document.getElementById("nav-logout").textContent = L.nav_logout;
      document.getElementById("nav-loan").textContent = L.nav_loan;
    }

    // --- Navbar Toggle ---
    function toggleMenu(){ document.getElementById("navbar-links").classList.toggle("show"); }

    // --- User Login / Dashboard ---
    function updateNavbar(){
      const user = JSON.parse(localStorage.getItem("user") || "{}");
      const dash = document.getElementById("dashboard-link");
      const login = document.getElementById("login-link");
      const logoutBtn = document.getElementById("logout-link");
      if(user && user.id){
        dash.style.display="inline-block";
        dash.querySelector("a").href = user.role==="farmer" ? "farmer.html":"buyer.html";
        login.style.display="none"; logoutBtn.style.display="inline-block";
      } else {
        dash.style.display="none"; login.style.display="inline-block"; logoutBtn.style.display="none";
      }
    }
    function logout(){ localStorage.removeItem("user"); updateNavbar(); window.location="index.html"; }
    function gotoDashboard(){
      const user = JSON.parse(localStorage.getItem("user") || "{}");
      if(user && user.id){ window.location=user.role==="farmer"?"farmer.html":"buyer.html"; }
      else{ window.location="login.html"; }
    }
    updateNavbar();

    // --- Weather ---
    async function loadWeather(){
      const el=document.getElementById('weatherStrip');
      try{
        const pos=await new Promise((res,rej)=>navigator.geolocation.getCurrentPosition(res,rej));
        const {latitude:lat,longitude:lon}=pos.coords;
        const r=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
        const j=await r.json();const w=j.current_weather;
        el.innerHTML=`<span class="weather-pill">üå°Ô∏è ${Math.round(w.temperature)}¬∞C</span>
                      <span class="weather-pill">üí® ${w.windspeed} km/h</span>`;
      }catch(e){ el.innerHTML="<span class='weather-pill'>‚ö†Ô∏è Weather unavailable</span>"; }
    }
    loadWeather();

    // --- Mock market prices ---
    const mockPrices = [
      { crop: "Wheat", region: "Maharashtra", price: 220, unit: "kg" },
      { crop: "Rice", region: "Karnataka", price: 45, unit: "kg" },
      { crop: "Maize", region: "Gujarat", price: 180, unit: "kg" },
      { crop: "Onion", region: "Punjab", price: 35, unit: "kg" },
      { crop: "Tomato", region: "Tamil Nadu", price: 40, unit: "kg" },
      { crop: "Wheat", region: "Punjab", price: 225, unit: "kg" },
      { crop: "Rice", region: "Maharashtra", price: 48, unit: "kg" },
    ];

    // --- Ticker ---
    function loadTicker(){
      const t = document.getElementById('priceTicker');
      t.innerHTML = mockPrices.map(p => 
        `<span>${p.crop} (${p.region}) <span class='badge'>‚Çπ${p.price}/${p.unit}</span></span>`
      ).join(" ‚Ä¢ ");
    }
    loadTicker();
    setInterval(loadTicker, 30000);

    // --- Price Widget ---
    function updatePriceWidget(){
      const crop = document.getElementById('cropSelect').value;
      const region = document.getElementById('regionSelect').value;
      const out = document.getElementById('priceResult');
      out.textContent = "Checking...";
      const result = mockPrices.find(p => p.crop===crop && p.region===region);
      if(result){
        const now = new Date();
        const ts = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        out.innerHTML = `Average price for <b>${result.crop}</b> in <b>${result.region}</b>: <b>‚Çπ${result.price}/${result.unit}</b><br><small>Last updated: ${ts}</small>`;
      } else {
        out.textContent = `No price found for ${crop} in ${region}.`;
      }
    }
    document.getElementById('priceForm').addEventListener('submit', ev=>{ ev.preventDefault(); updatePriceWidget(); });
    setInterval(updatePriceWidget, 60000);

    // --- Load saved language ---
    window.addEventListener("load", ()=>{
      const savedLang = localStorage.getItem("lang") || "en";
      document.getElementById("langSelect").value = savedLang;
      changeLanguage();
    });
  </script>

</body>
</html>
