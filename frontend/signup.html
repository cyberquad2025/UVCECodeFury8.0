<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AgriMitra | Signup</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --green: #2d6a4f;
      --dark: #1b4332;
      --light: #d4fc79;
      --white: #fff;
      --bg: linear-gradient(135deg, #43cea2, #185a9d);
    }

    * { box-sizing: border-box; }
    body {
      margin:0;
      font-family: "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--white);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    /* Weather strip */
    .weather-strip {
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:center;
      padding:6px 12px;
      background: rgba(0,0,0,0.22);
      font-size:14px;
      flex-wrap:wrap;
    }
    .weather-pill {
      background: rgba(255,255,255,0.12);
      padding:4px 10px;
      border-radius:999px;
      display:inline-flex;
      gap:6px;
      align-items:center;
      font-weight:600;
    }
    .small-muted { opacity:0.9; font-weight:500; }

    /* Navbar */
    nav {
      display:flex;
      justify-content:space-between;
      align-items:center;
      background: rgba(0,0,0,0.18);
      padding:14px 20px;
      position:relative;
    }
    .logo{font-weight:bold; font-size:20px;}
    nav ul{list-style:none; display:flex; gap:20px; margin:0; padding:0; align-items:center;}
    nav a{color:#fff; text-decoration:none; font-weight:600;}
    nav a:hover{ color: var(--light); }
    .menu-toggle{display:none; font-size:26px; cursor:pointer;}
    @media(max-width:768px){
      nav ul{display:none; flex-direction:column; gap:14px; background:rgba(0,0,0,0.9);
             position:absolute; top:100%; left:0; width:100%; padding:18px 0; text-align:center;}
      nav ul.show{display:flex;}
      .menu-toggle{display:block;}
    }

    /* Signup card */
    .main {
      flex:1;
      display:flex;
      justify-content:center;
      align-items:center;
      padding:40px 20px;
    }
    .container {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(6px);
      padding: 30px 25px;
      border-radius: 16px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.3);
      width: 100%;
      max-width: 400px;
      color: #fff;
    }
    h2 {
      text-align:center;
      margin-bottom:20px;
      font-size:28px;
      font-weight:800;
    }
    input, select, button {
      width:100%;
      padding:12px;
      margin:8px 0;
      border-radius:10px;
      border:none;
      font-size:15px;
    }
    input, select {
      background: rgba(255,255,255,0.9);
      color:#222;
    }
    input:focus, select:focus {
      outline:none;
      box-shadow:0 0 6px rgba(45,106,79,0.5);
    }
    button {
      background: var(--green);
      font-weight:bold;
      cursor:pointer;
      color:#fff;
      border:none;
      transition: 0.3s;
    }
    button:hover { background: var(--dark); }
    .switch { text-align:center; margin-top:12px; font-size:14px; }
    .switch a { color: var(--light); font-weight:bold; text-decoration:none; }
    .switch a:hover { text-decoration: underline; }

    /* Responsive */
    @media(max-width:480px){
      .container{padding:25px 20px;}
      h2{font-size:22px;}
    }
  </style>
</head>
<body>

<!-- Weather strip -->
<div class="weather-strip" id="weatherStrip">
  <span class="small-muted">Loading weather‚Ä¶</span>
</div>

<!-- Navbar -->
<nav>
  <div class="logo">üåæ AgriMitra</div>
  <span class="menu-toggle" onclick="toggleMenu()">‚ò∞</span>
  <ul id="navbar-links">
    <li><a href="index.html">Home</a></li>
    <li><a href="marketplace.html">Marketplace</a></li>
    <li><a href="equipment.html">Equipment</a></li>
    <li><a href="login.html">Login</a></li>
  </ul>
</nav>

<!-- Signup Form -->
<div class="main">
  <div class="container">
    <h2>üå± Signup for AgriMitra</h2>
    <form id="signupForm">
      <input type="text" id="signupName" placeholder="Name" required>
      <input type="email" id="signupEmail" placeholder="Email" required>
      <input type="password" id="signupPassword" placeholder="Password" required>
      <select id="signupRole">
        <option value="farmer">üë®‚Äçüåæ Farmer</option>
        <option value="buyer">üõí Buyer</option>
      </select>
      <button type="submit">Signup</button>
    </form>
    <div class="switch">
      <p>Already have an account? <a href="login.html">Login here</a></p>
    </div>
  </div>
</div>

<script>
const API = "http://127.0.0.1:5000";

function toggleMenu(){
  document.getElementById("navbar-links").classList.toggle("show");
}

/* Weather */
async function loadWeather(){
  const el = document.getElementById('weatherStrip');
  try{
    const pos = await new Promise((res, rej) => navigator.geolocation.getCurrentPosition(res, rej));
    const { latitude:lat, longitude:lon } = pos.coords;
    const r = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
    const j = await r.json();
    const w = j.current_weather;
    el.innerHTML = `
      <span class="weather-pill">üå°Ô∏è ${Math.round(w.temperature)}¬∞C</span>
      <span class="weather-pill">üí® ${w.windspeed} km/h</span>
    `;
  } catch(e){
    el.innerHTML = "<span class='weather-pill'>‚ö†Ô∏è Weather unavailable</span>";
  }
}
loadWeather();

/* Signup form */
document.getElementById("signupForm").addEventListener("submit", async (e)=>{
  e.preventDefault();
  const res = await fetch(API+"/signup", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body: JSON.stringify({
      name: document.getElementById("signupName").value,
      email: document.getElementById("signupEmail").value,
      password: document.getElementById("signupPassword").value,
      role: document.getElementById("signupRole").value
    })
  });
  const data = await res.json();
  alert(data.message || data.error);
  if(data.message){
    window.location = "login.html";
  }
});
</script>
</body>
</html>
