<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>AgriMitra | Equipment Marketplace</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
:root {
  --green:#2d6a4f; --dark:#1b4332; --bg:#f6fff9; --light:#d8f3dc;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:'Segoe UI',sans-serif;background:var(--bg);color:#222;transition:0.3s;}

/* Weather Strip */
.weather-strip{display:flex;gap:12px;align-items:center;justify-content:center;padding:8px;background:rgba(0,0,0,0.22);color:#fff;font-size:14px;flex-wrap:wrap;}
.weather-pill{background: rgba(255,255,255,0.12);padding:6px 10px;border-radius:999px;font-weight:600;}

/* Navbar */
nav{display:flex;justify-content:space-between;align-items:center;background:var(--green);color:#fff;padding:12px 20px;position:relative;}
.logo{font-size:20px;font-weight:bold;}
nav ul{list-style:none;display:flex;gap:20px;margin:0;}
nav a{color:#fff;text-decoration:none;font-weight:500;}
nav a:hover{text-decoration:underline;}
.menu-toggle{display:none;font-size:26px;cursor:pointer;}
@media(max-width:768px){
  nav ul{display:none;flex-direction:column;background:rgba(0,0,0,0.9);position:absolute;top:100%;left:0;width:100%;padding:16px 0;text-align:center;gap:16px;}
  nav ul.show{display:flex;}
  .menu-toggle{display:block;}
}
#langSelect{padding:6px;border-radius:6px;font-weight:600;}

/* Container */
.container{max-width:1100px;margin:20px auto;padding:20px;display:flex;flex-direction:column;gap:20px;}
h1{color:var(--green);margin-bottom:6px;}
p.lead{color:#555;margin-bottom:20px;}

/* Equipment grid */
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:20px;}
.card{background:#fff;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.08);padding:16px;display:flex;flex-direction:column;justify-content:space-between;transition:transform 0.2s;}
.card:hover{transform:translateY(-4px);}
.card img{width:100%;height:150px;object-fit:cover;border-radius:8px;margin-bottom:10px;}
.card h3{margin:0 0 8px;color:var(--dark);}
.card .meta{font-size:14px;color:#555;margin-bottom:8px;}
.card .price{font-weight:bold;color:var(--green);margin-bottom:12px;}
.card button{background:var(--green);color:#fff;border:none;padding:10px;border-radius:8px;cursor:pointer;font-size:14px;transition:0.2s;}
.card button:hover{background:var(--dark);}
</style>
</head>
<body>

<div class="weather-strip" id="weatherStrip"><span>Loading weather...</span></div>

<nav>
  <div class="logo">ЁЯМ╛ AgriMitra</div>
  <span class="menu-toggle" onclick="toggleMenu()">тШ░</span>
  <ul id="navbar-links"></ul>
  <select id="langSelect" onchange="changeLanguage()">
    <option value="en">English</option>
    <option value="hi">рд╣рд┐рдиреНрджреА</option>
    <option value="ta">родрооро┐ро┤рпН</option>
    <option value="te">р░др▒Жр░▓р▒Бр░Чр▒Б</option>
    <option value="kn">р▓Хр▓ир│Нр▓ир▓б</option>
  </select>
</nav>

<div class="container">
  <div>
    <h1 id="main-title">тЪЩя╕П Equipment Marketplace</h1>
    <p class="lead" id="main-lead">Browse and rent farming equipment from nearby farmers</p>
  </div>
  <div class="grid" id="list">Loading equipment...</div>
</div>

<script>
const translations = {
  en: { nav_home:"Home", nav_market:"Crop Marketplace", nav_fertilizers:"Fertilizers & Manures", nav_equipment:"Equipment", nav_dashboard:"Dashboard", nav_logout:"Logout", nav_login:"Login/Signup", main_title:"тЪЩя╕П Equipment Marketplace", main_lead:"Browse and rent farming equipment from nearby farmers", loading_eq:"Loading equipment...", book:"Book Now", alert_login:"Please login to book" },
  hi: { nav_home:"рд╣реЛрдо", nav_market:"рдлрд╕рд▓ рдмрд╛рдЬрд╝рд╛рд░", nav_fertilizers:"рдЙрд░реНрд╡рд░рдХ рдФрд░ рдЦрд╛рдж", nav_equipment:"рдЙрдкрдХрд░рдг", nav_dashboard:"рдбреИрд╢рдмреЛрд░реНрдб", nav_logout:"рд▓реЙрдЧрдЖрдЙрдЯ", nav_login:"рд▓реЙрдЧрд┐рди/рд╕рд╛рдЗрдирдЕрдк", main_title:"тЪЩя╕П рдЙрдкрдХрд░рдг рдорд╛рд░реНрдХреЗрдЯрдкреНрд▓реЗрд╕", main_lead:"рдкрд╛рд╕ рдХреЗ рдХрд┐рд╕рд╛рдиреЛрдВ рд╕реЗ рдХреГрд╖рд┐ рдЙрдкрдХрд░рдг рдмреНрд░рд╛рдЙрдЬрд╝ рдФрд░ рдХрд┐рд░рд╛рдП рдкрд░ рд▓реЗрдВ", loading_eq:"рдЙрдкрдХрд░рдг рд▓реЛрдб рд╣реЛ рд░рд╣реЗ рд╣реИрдВ...", book:"рдмреБрдХ рдХрд░реЗрдВ", alert_login:"рдмреБрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓реЙрдЧрд┐рди рдХрд░реЗрдВ" },
  ta: { nav_home:"роорпБроХрокрпНрокрпБ", nav_market:"рокропро┐ро░рпН роЪроирпНродрпИ", nav_fertilizers:"роЙро░роЩрпНроХро│рпН рооро▒рпНро▒рпБроорпН роЙро░роЩрпНроХро│рпН", nav_equipment:"роЪро╛родройроЩрпНроХро│рпН", nav_dashboard:"роЯро╛ро╖рпНрокрпЛро░рпНроЯрпН", nav_logout:"ро╡рпЖро│ро┐ропрпЗро▒рпБ", nav_login:"роЙро│рпНроирпБро┤рпИ/рокродро┐ро╡рпБ роЪрпЖропрпН", main_title:"тЪЩя╕П роЪро╛родройроЩрпНроХро│рпН роЪроирпНродрпИ", main_lead:"роирпЖро░рпБроЩрпНроХро┐роп ро╡ро┐ро╡роЪро╛ропро┐роХро│ро┐роЯрооро┐ро░рпБроирпНродрпБ роЙрокроХро░рогроЩрпНроХро│рпИ роЙро▓ро╛ро╡ро╡рпБроорпН рооро▒рпНро▒рпБроорпН ро╡ро╛роЯроХрпИроХрпНроХрпБ роОроЯрпБроХрпНроХро╡рпБроорпН", loading_eq:"роЪро╛родройроЩрпНроХро│рпН роПро▒рпНро▒рокрпНрокроЯрпБроХро┐ро▒родрпБ...", book:"ро╡ро╛роЯроХрпИ роОроЯрпБ", alert_login:"ро╡ро╛роЯроХрпИроХрпНроХрпБ роЙро│рпНроирпБро┤рпИропро╡рпБроорпН" },
  te: { nav_home:"р░╣р▒Лр░ор▒Н", nav_market:"р░кр░Вр░Яр░▓ р░ор░╛р░░р▒Нр░Хр▒Жр░Яр▒НтАМр░кр▒Нр░▓р▒Зр░╕р▒Н", nav_fertilizers:"р░Ор░░р▒Бр░╡р▒Бр░▓р▒Б & р░╕р▒Зр░Вр░жр▒Нр░░р▒Ар░п р░Ор░░р▒Бр░╡р▒Бр░▓р▒Б", nav_equipment:"р░кр░░р░┐р░Хр░░р░╛р░▓р▒Б", nav_dashboard:"р░бр░╛р░╖р▒НтАМр░мр▒Лр░░р▒Нр░бр▒Н", nav_logout:"р░▓р░╛р░Чр▒Н р░Ер░╡р▒Бр░Яр▒Н", nav_login:"р░▓р░╛р░Чр░┐р░ир▒Н/р░╕р▒Ир░ир▒Н-р░Ер░кр▒Н", main_title:"тЪЩя╕П р░кр░░р░┐р░Хр░░р░╛р░▓ р░ор░╛р░░р▒Нр░Хр▒Жр░Яр▒Н", main_lead:"р░╕р░ор▒Ар░к р░░р▒Ир░др▒Бр░▓ р░ир▒Бр░Вр░бр░┐ р░кр░░р░┐р░Хр░░р░╛р░▓р░ир▒Б р░мр▒Нр░░р▒Мр░Ьр▒Н р░Ър▒Зр░╕р░┐ р░Ер░жр▒Нр░жр▒Жр░Хр▒Б р░др▒Ар░╕р▒Бр░Хр▒Лр░Вр░бр░┐", loading_eq:"р░кр░░р░┐р░Хр░░р░╛р░▓р▒Б р░▓р▒Лр░бр▒Н р░Ер░╡р▒Бр░др▒Бр░ир▒Нр░ир░╛р░пр░┐...", book:"р░мр▒Бр░Хр▒Н р░Ър▒Зр░пр░Вр░бр░┐", alert_login:"р░мр▒Бр░Хр▒Н р░Ър▒Зр░пр░бр░╛р░ир░┐р░Хр░┐ р░▓р░╛р░Чр░┐р░ир▒Н р░Ър▒Зр░пр░Вр░бр░┐" },
  kn: { nav_home:"р▓╣р│Лр▓ор│Н", nav_market:"р▓мр│Жр▓│р│Ж р▓ор▓╛р▓░р│Бр▓Хр▓Яр│Нр▓Яр│Ж", nav_fertilizers:"р▓Чр│Кр▓мр│Нр▓мр▓░ р▓ор▓др│Нр▓др│Б р▓░р▓╕р▓Чр│Кр▓мр│Нр▓мр▓░р▓Чр▓│р│Б", nav_equipment:"р▓Йр▓кр▓Хр▓░р▓г", nav_dashboard:"р▓бр│Нр▓пр▓╛р▓╢р│НтАМр▓мр│Лр▓░р│Нр▓бр│Н", nav_logout:"р▓▓р▓╛р▓Чр│Н р▓Фр▓Яр│Н", nav_login:"р▓▓р▓╛р▓Чр▓┐р▓ир│Н/р▓╕р│Ир▓ир│Н-р▓Ер▓кр│Н", main_title:"тЪЩя╕П р▓Йр▓кр▓Хр▓░р▓г р▓ор▓╛р▓░р│Бр▓Хр▓Яр│Нр▓Яр│Ж", main_lead:"р▓╣р▓др│Нр▓др▓┐р▓░р▓ж р▓░р│Ир▓др▓░р▓┐р▓Вр▓ж р▓Хр│Гр▓╖р▓┐ р▓Йр▓кр▓Хр▓░р▓гр▓Чр▓│р▓ир│Нр▓ир│Б р▓мр│Нр▓░р│Мр▓╕р│Н р▓ор▓╛р▓бр▓┐ р▓ор▓др│Нр▓др│Б р▓мр▓╛р▓бр▓┐р▓Чр│Жр▓Чр│Ж р▓кр▓бр│Жр▓пр▓┐р▓░р▓┐", loading_eq:"р▓Йр▓кр▓Хр▓░р▓г р▓▓р│Лр▓бр│Н р▓Жр▓Чр│Бр▓др│Нр▓др▓┐р▓жр│Ж...", book:"р▓мр│Бр▓Хр│Н р▓ор▓╛р▓бр▓┐", alert_login:"р▓мр│Бр▓Хр│Н р▓ор▓╛р▓бр▓▓р│Б р▓▓р▓╛р▓Чр▓┐р▓ир│Н р▓ор▓╛р▓бр▓┐" }
};

let lang = localStorage.getItem("lang") || "en";
let L = translations[lang];
let user = JSON.parse(localStorage.getItem("user")||"{}");

function toggleMenu(){ document.getElementById("navbar-links").classList.toggle("show"); }
function logout(){ localStorage.removeItem("user"); renderNavbar(); window.location="index.html"; }

function renderNavbar(){
  L = translations[localStorage.getItem("lang")||"en"];
  user = JSON.parse(localStorage.getItem("user")||"{}");
  const nav = document.getElementById("navbar-links");
  nav.innerHTML = `
    <li><a href="index.html">${L.nav_home}</a></li>
    <li><a href="marketplace.html">${L.nav_market}</a></li>
    <li><a href="fertilizers.html">${L.nav_fertilizers}</a></li>
    <li><a href="equipment.html">${L.nav_equipment}</a></li>
    ${user && user.id ? `<li><a href="${user.role==="farmer"?"farmer.html":"buyer.html"}">${L.nav_dashboard}</a></li>
                         <li><a href="#" onclick="logout()">${L.nav_logout}</a></li>` : `<li><a href="login.html">${L.nav_login}</a></li>`}
  `;
}

function applyTranslations(){
  L = translations[localStorage.getItem("lang")||"en"];
  document.getElementById("main-title").textContent = L.main_title;
  document.getElementById("main-lead").textContent = L.main_lead;
  document.getElementById("langSelect").value = localStorage.getItem("lang")||"en";
}

function changeLanguage(){
  const sel = document.getElementById("langSelect").value;
  localStorage.setItem("lang", sel);
  applyTranslations();
  renderNavbar();
  load();
}

/* Load Equipment */
function load(){
  const el = document.getElementById("list");
  el.textContent = L.loading_eq;

  const sample = [
    {id:1,name:"Tractor",farmer_name:"Ravi Kumar",rent_price:2000,img:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT1DzqFJ-uX4N9Hm1AO-o88YUgG40sl6WPJTg&s"},
    {id:2,name:"Rotavator",farmer_name:"Sita Devi",rent_price:1200,img:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSN5LCkdhmbRlrtQmIHBxj945EQM3UaL4VHng&s"},
    {id:3,name:"Seeder",farmer_name:"Mohan",rent_price:800,img:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c2/National_Agro_Happy_Seeder.jpg/1200px-National_Agro_Happy_Seeder.jpg"},
    {id:4,name:"Sprayer",farmer_name:"Anil",rent_price:400,img:"https://pre-live-admin.balwaan.com/uploads/media/2024/manual-sprayer-for-garden-20-liter-1.jpg"},
    {id:5,name:"Harvester",farmer_name:"Lakshmi",rent_price:2500,img:"https://www.mechanicalpower.net/wp-content/uploads/2023/05/Combine-Harvester.jpg"}
  ];

  el.innerHTML = sample.map(e=>`
    <div class="card">
      <img src="${e.img}" alt="${e.name}">
      <h3>${e.name}</h3>
      <div class="meta">By: ${e.farmer_name}</div>
      <div class="price">тВ╣${e.rent_price}/day</div>
      <button onclick="book(${e.id})">${L.book}</button>
    </div>
  `).join("");
}

/* Book equipment */
function book(id){
  user = JSON.parse(localStorage.getItem("user")||"{}");
  if(!user.id){ alert(L.alert_login); window.location="login.html"; return; }
  const start = prompt("Start date (YYYY-MM-DD)");
  const end = prompt("End date (YYYY-MM-DD)");
  if(!start||!end) return;
  alert(`Equipment booked from ${start} to ${end}`);
}

/* Weather */
async function loadWeather(){
  const el = document.getElementById('weatherStrip');
  try{
    const pos = await new Promise((res,rej)=>navigator.geolocation.getCurrentPosition(res,rej));
    const {latitude:lat,longitude:lon} = pos.coords;
    const r = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
    const j = await r.json();
    const w = j.current_weather;
    el.innerHTML = `<span class="weather-pill">ЁЯМбя╕П ${Math.round(w.temperature)}┬░C</span>
                    <span class="weather-pill">ЁЯТи ${w.windspeed} km/h</span>`;
  }catch(e){ el.innerHTML="<span class='weather-pill'>тЪая╕П Weather unavailable</span>"; }
}

/* Init */
applyTranslations();
renderNavbar();
load();
loadWeather();
</script>
</body>
</html>
